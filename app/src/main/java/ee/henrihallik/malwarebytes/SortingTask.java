package ee.henrihallik.malwarebytes;

import android.os.AsyncTask;

import java.io.File;
import java.util.ArrayList;


public class SortingTask extends AsyncTask<SortingTask.MODES, Void, Boolean> {
    public enum MODES {ALPHABETICAL, CHRONOLOGICAL, BY_EXTENSION}

    public interface OnPostSortListener{
        void onPostExecute(ArrayList<File> files);
    }

    private final ArrayList<File> mFiles;
    private final OnPostSortListener mOnPostSortListener;
    public SortingTask(ArrayList<File> files, OnPostSortListener onPostSortListener){
        mFiles = files;
        mOnPostSortListener = onPostSortListener;
    }

    @Override
    protected Boolean doInBackground(MODES... params) {
        switch(params[0]){
            case ALPHABETICAL:
                mFiles.sort((file1, file2) -> file1.getName().compareTo(file2.getName()));
                return true;
            case CHRONOLOGICAL:
                mFiles.sort((file1, file2) -> Long.compare(file1.lastModified(), file2.lastModified()));
                return true;
            case BY_EXTENSION:
                mFiles.sort((file1, file2) -> getExt(file1.getName()).compareTo(getExt(file2.getName())));
                return true;
        }

        return false;
    }
    @Override
    protected void onPostExecute(Boolean success) {
        if(success) mOnPostSortListener.onPostExecute(mFiles);
    }

    public String getExt(String fileName){
        int strLength = fileName.lastIndexOf(".");
        if(strLength > 0) return fileName.substring(strLength + 1).toLowerCase();
        return "";
    }
}